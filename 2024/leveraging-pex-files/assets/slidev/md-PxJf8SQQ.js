import{A as R,B as I}from"../modules/unplugin-icons-Bd3gzhd8.js";import{d as w,t as L,Q as H,D as C,O as M,z as v,aC as V,o as h,b,f as z,B as c,c as m,g as S,i as O,h as P,k as B,l as q,m as U,q as j,s as K,e as s,aa as e}from"../modules/vue-B3MSS8ay.js";import{v as x,aa as W,C as T,ad as X,ac as Q}from"../index-CM3Ct9rq.js";import{u as F,f as Y}from"./context-DSAf3mji.js";import{I as G}from"./default-OtmCV-MJ.js";import"../modules/shiki-CVHpc8su.js";const J=["title"],Z=w({__name:"CodeBlockWrapper",props:{ranges:{type:Array,default:()=>[]},finally:{type:[String,Number],default:"last"},startLine:{type:Number,default:1},lines:{type:Boolean,default:x.lineNumbers},at:{type:[String,Number],default:"+1"},maxHeight:{type:String,default:void 0}},setup(y){const i=y,{$clicksContext:r}=F(),a=L(),d=W();H(()=>{r.unregister(d)}),C(()=>{var t;(t=a.value)==null||t.classList.toggle("slidev-code-line-numbers",i.lines)}),M(()=>{var p;if(!r||!((p=i.ranges)!=null&&p.length))return;const t=r.calculateSince(i.at,i.ranges.length-1);r.register(d,t);const l=v(()=>t?Math.max(0,r.current-t.start+1):T),n=v(()=>i.finally==="last"?i.ranges.at(-1):i.finally.toString());C(()=>{if(!a.value)return;let k=i.ranges[l.value]??n.value;const D=k==="hide";a.value.classList.toggle(X,D),D&&(k=i.ranges[l.value+1]??n.value);const A=a.value.querySelector(".shiki"),_=Array.from(A.querySelectorAll("code > .line")),$=_.length;if(Q(k,$,i.startLine,o=>[_[o]]),i.maxHeight){const o=Array.from(A.querySelectorAll(".line.highlighted"));o.reduce((E,N)=>N.offsetHeight+E,0)>a.value.offsetHeight?o[0].scrollIntoView({behavior:"smooth",block:"start"}):o.length>0&&o[Math.round((o.length-1)/2)].scrollIntoView({behavior:"smooth",block:"center"})}})});const{copied:u,copy:f}=V();function g(){var l,n;const t=(n=(l=a.value)==null?void 0:l.querySelector(".slidev-code"))==null?void 0:n.textContent;t&&f(t)}return(t,l)=>{const n=R,p=I;return h(),b("div",{ref_key:"el",ref:a,class:O(["slidev-code-wrapper relative group",{"slidev-code-line-numbers":i.lines}]),style:P({"max-height":i.maxHeight,"overflow-y":i.maxHeight?"scroll":void 0,"--start":i.startLine})},[z(t.$slots,"default"),c(x).codeCopy?(h(),b("button",{key:0,class:"slidev-code-copy absolute top-0 right-0 transition opacity-0 group-hover:opacity-20 hover:!opacity-100",title:c(u)?"Copied":"Copy",onClick:l[0]||(l[0]=k=>g())},[c(u)?(h(),m(n,{key:0,class:"p-2 w-8 h-8"})):(h(),m(p,{key:1,class:"p-2 w-8 h-8"}))],8,J)):S("v-if",!0)],6)}}}),ss=s("h1",null,"Build from docker and deploy",-1),es=s("p",null,[e("Full source code here: "),s("a",{href:"https://github.com/yujinyuz/mubo/tree/pexample",target:"_blank"},"https://github.com/yujinyuz/mubo/tree/pexample")],-1),is=s("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light slidev-code",style:{"--shiki-dark":"#dbd7caee","--shiki-light":"#393a34","--shiki-dark-bg":"#121212","--shiki-light-bg":"#ffffff"}},[s("code",{class:"language-dockerfile"},[s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},"# Build stage")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"FROM"),s("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," python:3.11-slim "),s("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"AS"),s("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," builder")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"...")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"RUN"),s("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," hatch build")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"RUN"),s("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," pex dist/*.whl -o mubo.pex -c mubo")]),e(`
`),s("span",{class:"line"}),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},"# Final stage")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"FROM"),s("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," python:3.11-slim")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"WORKDIR"),s("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," /usr/src/app")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},"# Copy the built artifact from the builder stage")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"COPY"),s("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," --from=builder /usr/src/app/mubo.pex .")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},"# Set execute permissions")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"RUN"),s("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," chmod +x mubo.pex")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"...")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},"# Expose the port the app runs on")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"EXPOSE"),s("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," 8000")]),e(`
`),s("span",{class:"line"}),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#758575DD","--shiki-light":"#A0ADA0"}},"# Run the application via custom management command")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#4D9375","--shiki-light":"#1E754F"}},"CMD"),s("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}}," ["),s("span",{style:{"--shiki-dark":"#C98A7D","--shiki-light":"#B56959"}},'"./mubo.pex"'),s("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},", "),s("span",{style:{"--shiki-dark":"#C98A7D","--shiki-light":"#B56959"}},'"rungunicorn"'),s("span",{style:{"--shiki-dark":"#DBD7CAEE","--shiki-light":"#393A34"}},"]")])])],-1),ts={__name:"slides.md__slidev_14",setup(y){const{$slidev:i,$nav:r,$clicksContext:a,$clicks:d,$page:u,$renderContext:f,$frontmatter:g}=F();return a.setup(),(t,l)=>{const n=Z;return h(),m(G,j(K(c(Y)(c(g),13))),{default:B(()=>[ss,S(" mubo "),es,q(n,U({},{ranges:[]}),{default:B(()=>[is]),_:1},16)]),_:1},16)}}},ps=ts;export{ps as default};
